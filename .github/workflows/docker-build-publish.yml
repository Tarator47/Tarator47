name: Build and Save Docker Image

on:
  push:
    branches:
      - main  # Trigger workflow on pushes to the 'main' branch
  pull_request:
    branches:
      - main  # Trigger workflow on pull requests to the 'main' branch

jobs:
  build-and-save:
    name: Build and Save Sudoku Docker Image
    runs-on: ubuntu-latest

    steps:
    # Step 1: Checkout the code
    - name: Checkout Code
      uses: actions/checkout@v3

    # Step 2: Build the Docker image
    - name: Build Docker Image
      run: |
        docker build -t sudoku-app:latest ./app

    # Step 3: Save Docker image to file
    - name: Save Docker Image
      run: |
        docker save -o sudoku-app.tar sudoku-app:latest
      shell: bash

    # Step 4: Upload Docker image as an artifact
    - name: Upload Docker Image
      uses: actions/upload-artifact@v4
      with:
        name: sudoku-app
        path: sudoku-app.tar
